# Совкод (.ussr) Транслятор и модель

- `alg | acc | harv | hw | instr | binary | stream | port | pstr | prob1 | 8bit`
- Без усложнения

Задание к лабораторной [lab3-task.md](/lab3-task.md).
Персональный вариант в файле [variant.md](/variant.md).

## Язык программирования

Синтаксис языка должен напоминать java/javascript/lua. Должен поддерживать математические выражения.

- необходимо объяснить, как происходит отображение больших выражений на регистры и память;
- необходимо продемонстрировать работу транслятора в случае, если количество регистров недостаточно для реализации
  алгоритма.

Язык назовём Совкод (`☭★Cоветский код★☭`)

### Типы данных

- цел - целочисленный (int)
- вещ - вещественный (float тип)
- симв - символьный (char тип)
- строка (указатель на строку в памяти)
  того 6 типов данных

### Операции

- `+ - / *` (классические операции сложения, вычитания, деления и умножения соотв.)
- `% ^ ~` мат. операции остаток от деления, возведение в степень и взятие корня.
- `!` логическое отрицание
- `&` побитовая конъюнкция
- `|` побитовая дизъюнкция
- `< > ==` отношения (меньше, больше и равно соответственно)
- `(переменная)++` `(переменная)--` операции инкремент и декремент соотв.
- `\>> (переменная)` чтение из потока ввода 1 символа
- `\<< (переменная)` запись в файл вывода 1 символа

### Выражения

#### `Если` Оператор условия (if)

* Оператор если выполняет код внутри блока {} при истинности логического выражения в скобках ().
* В случае ложности выражения, код в блоке иначе выполняется (если он присутствует).
* Пример:

> `если` _(...)_ { кол_во++; }  
> `иначе` { кол-во--; }

#### `Пока` - оператор цикла (while)

Оператор пока выполняет код внутри блока {} до тех пор, пока логическое выражение в скобках () истинно.
Пример:
> `пока` _((кол_во > 12) & (a + b == 12))_ {...}

`/*` _текст комментария_ `*/` - комментарии

#### Логическое выражение

Логические выражения могут содержать сравнения, логические операторы (&, |, !), и могут быть вложены в скобки.
Пример:
> ((кол_во > 12) & (a + b == 12))

#### Комментарии:

* Комментарии начинаются с символа # и распространяются до конца строки.
* Пример:

> цел а = 5; `# Это комментарий`

### Формальное описание синтаксиса

<details><summary>Формальное описание Совкода по форме Бэкуса-Наура</summary>

    <Совкод> ::= { <Объявление> | <Оператор> | <Комментарий> }
    
    <Объявление> ::= <Тип> <Идентификатор> {, <Идентификатор>} ;
    
    <Тип> ::= "цел" | "вещ" | "симв" | "строка"
    
    <Идентификатор> ::= <Буква> {<Буква> | <Цифра>}
    
    <Буква> ::= "a" | "b" | ... | "z" | "A" | "B" | ... | "Z" | "_"
    
    <Цифра> ::= "0" | "1" | ... | "9"
    
    <Оператор> ::= "если" "(" <Логическое_выражение> ")" "{" <Код> "}" ["иначе" "{" <Код> "}"]
     | "пока" "(" <Логическое_выражение> ")" "{" <Код> "}"
     | "#" <Текст_комментария>
     | <Выражение> ";"
    
    <Логическое_выражение> ::= <Сравнение> | <Логическое_выражение> "&" <Логическое_выражение>
     | <Логическое_выражение> "|" <Логическое_выражение>
     | "!" <Логическое_выражение>
    
    <Сравнение> ::= <Арифметическое_выражение> ("<" | ">" | "==") <Арифметическое_выражение>
    
    <Арифметическое_выражение> ::= <Терм> {"+" | "-" <Терм>}
    
    <Терм> ::= <Фактор> {"*" | "/" <Фактор>}
    
    <Фактор> ::= <Операнд> {"%" | "^" | "~" }
    
    <Операнд> ::= "(" <Логическое_выражение> ")"
     | <Идентификатор>
     | <Константа>
     | "\" ">>" "(" <Идентификатор> ")"
     | "\" "<<" "(" <Идентификатор> ")"
    
    <Константа> ::= <Целое> | <Вещественное> | <Логическое> | <Символьное>
    
    <Целое> ::= <Цифра> {<Цифра>}
    
    <Вещественное> ::= <Целое> "." <Целое>
    
    <Символьное> ::= "'" <Символ> "'"
    
    <Символ> ::= <Буква> | <Цифра> | ... | <Спецсимвол>
    
    <Спецсимвол> ::= "@", "#", "$", ...
    
    <Код> ::= { <Объявление> | <Оператор> }
    
    <Комментарий> ::= "#" <Текст_комментария>
    
    <Текст_комментария> ::= <Любой_текст_комментария>
    
    <Любой_текст_комментария> ::= {<Любой_символ>}
    
    <Любой_символ> ::= <Буква> | <Цифра> | <
    
     <
     Спецсимвол> | " " | "," | "." | ";" | "(" | ")" | "{" | "}" | "'" | "\" | "=" | "!" | "&" | "|" | "<" | ">" | "+" | "-" | "*" | "/" | "%" | "^" | "~"
     ... Как-то так

</details>

Таким образом, семантика ☭★Совкода★☭ определяет порядок выполнения кода, правила объявления переменных,
структуру условных операторов и циклов, а также различные операции, которые могут быть использованы в программах на этом
языке.

## Компилятор Совкода _Stalin_

`stalin <путь до исходника .ussr> <имя бинарника>`

### Входные данные
* Имя файла с исходным кодом в текстовом виде.
* Имя файла для сохранения полученного машинного кода.

### Выходные данные
* В поток ошибок записывается ассемблерное представление кода
* В поток ошибок записывается память данных
* В поток ошибок записываются количества строк кода в реализации алгоритма, количество инструкций и количество байтов в бинарном файле в целом
* В файл записывает байткод программы

### Основные этапы компиляции